#version 330

in vec2 fragTexCoord;
in vec4 fragColor;

uniform sampler2D texture0;
uniform vec4 colDiffuse;
uniform float light_intensity;

out vec4 finalColor;

void main() {
  const vec3 gnbu_colors[256] = vec3[256](
    vec3(  0.0,   0.0,   0.0) / 255.0,
    vec3(  0.0,   0.0,   0.0) / 255.0,
    vec3(  0.0,   0.0,   0.0) / 255.0,
    vec3(  1.0,   0.0,   0.0) / 255.0,
    vec3(  1.0,   1.0,   1.0) / 255.0,
    vec3(  2.0,   1.0,   1.0) / 255.0,
    vec3(  3.0,   1.0,   1.0) / 255.0,
    vec3(  4.0,   1.0,   2.0) / 255.0,
    vec3(  5.0,   2.0,   2.0) / 255.0,
    vec3(  6.0,   2.0,   3.0) / 255.0,
    vec3(  7.0,   2.0,   3.0) / 255.0,
    vec3(  9.0,   3.0,   4.0) / 255.0,
    vec3( 11.0,   3.0,   5.0) / 255.0,
    vec3( 13.0,   4.0,   5.0) / 255.0,
    vec3( 14.0,   4.0,   6.0) / 255.0,
    vec3( 16.0,   5.0,   7.0) / 255.0,
    vec3( 18.0,   5.0,   8.0) / 255.0,
    vec3( 20.0,   5.0,   9.0) / 255.0,
    vec3( 21.0,   6.0,   9.0) / 255.0,
    vec3( 23.0,   6.0,  10.0) / 255.0,
    vec3( 25.0,   7.0,  11.0) / 255.0,
    vec3( 27.0,   7.0,  12.0) / 255.0,
    vec3( 28.0,   8.0,  13.0) / 255.0,
    vec3( 30.0,   8.0,  14.0) / 255.0,
    vec3( 32.0,   9.0,  15.0) / 255.0,
    vec3( 34.0,   9.0,  15.0) / 255.0,
    vec3( 35.0,   9.0,  16.0) / 255.0,
    vec3( 37.0,  10.0,  17.0) / 255.0,
    vec3( 39.0,  10.0,  18.0) / 255.0,
    vec3( 41.0,  11.0,  18.0) / 255.0,
    vec3( 42.0,  11.0,  19.0) / 255.0,
    vec3( 44.0,  11.0,  20.0) / 255.0,
    vec3( 46.0,  11.0,  20.0) / 255.0,
    vec3( 48.0,  12.0,  21.0) / 255.0,
    vec3( 50.0,  12.0,  22.0) / 255.0,
    vec3( 51.0,  12.0,  22.0) / 255.0,
    vec3( 53.0,  12.0,  23.0) / 255.0,
    vec3( 55.0,  13.0,  24.0) / 255.0,
    vec3( 57.0,  13.0,  24.0) / 255.0,
    vec3( 59.0,  13.0,  25.0) / 255.0,
    vec3( 60.0,  13.0,  25.0) / 255.0,
    vec3( 62.0,  13.0,  26.0) / 255.0,
    vec3( 64.0,  13.0,  26.0) / 255.0,
    vec3( 66.0,  13.0,  27.0) / 255.0,
    vec3( 68.0,  13.0,  27.0) / 255.0,
    vec3( 70.0,  13.0,  27.0) / 255.0,
    vec3( 71.0,  13.0,  28.0) / 255.0,
    vec3( 73.0,  13.0,  28.0) / 255.0,
    vec3( 75.0,  13.0,  29.0) / 255.0,
    vec3( 77.0,  12.0,  29.0) / 255.0,
    vec3( 79.0,  12.0,  29.0) / 255.0,
    vec3( 81.0,  12.0,  29.0) / 255.0,
    vec3( 83.0,  12.0,  30.0) / 255.0,
    vec3( 84.0,  11.0,  30.0) / 255.0,
    vec3( 86.0,  11.0,  30.0) / 255.0,
    vec3( 88.0,  11.0,  30.0) / 255.0,
    vec3( 90.0,  10.0,  30.0) / 255.0,
    vec3( 92.0,  10.0,  30.0) / 255.0,
    vec3( 94.0,   9.0,  30.0) / 255.0,
    vec3( 96.0,   9.0,  30.0) / 255.0,
    vec3( 98.0,   8.0,  30.0) / 255.0,
    vec3( 99.0,   7.0,  30.0) / 255.0,
    vec3(101.0,   7.0,  30.0) / 255.0,
    vec3(103.0,   6.0,  30.0) / 255.0,
    vec3(105.0,   5.0,  29.0) / 255.0,
    vec3(107.0,   5.0,  29.0) / 255.0,
    vec3(109.0,   4.0,  29.0) / 255.0,
    vec3(111.0,   4.0,  28.0) / 255.0,
    vec3(112.0,   3.0,  28.0) / 255.0,
    vec3(114.0,   3.0,  27.0) / 255.0,
    vec3(116.0,   2.0,  26.0) / 255.0,
    vec3(118.0,   2.0,  26.0) / 255.0,
    vec3(119.0,   2.0,  25.0) / 255.0,
    vec3(121.0,   2.0,  24.0) / 255.0,
    vec3(123.0,   3.0,  23.0) / 255.0,
    vec3(124.0,   3.0,  22.0) / 255.0,
    vec3(126.0,   4.0,  21.0) / 255.0,
    vec3(127.0,   6.0,  21.0) / 255.0,
    vec3(128.0,   7.0,  20.0) / 255.0,
    vec3(130.0,   9.0,  19.0) / 255.0,
    vec3(131.0,  11.0,  18.0) / 255.0,
    vec3(132.0,  13.0,  17.0) / 255.0,
    vec3(133.0,  15.0,  16.0) / 255.0,
    vec3(134.0,  17.0,  15.0) / 255.0,
    vec3(135.0,  19.0,  14.0) / 255.0,
    vec3(136.0,  21.0,  13.0) / 255.0,
    vec3(137.0,  23.0,  12.0) / 255.0,
    vec3(138.0,  25.0,  11.0) / 255.0,
    vec3(139.0,  27.0,  11.0) / 255.0,
    vec3(140.0,  29.0,  10.0) / 255.0,
    vec3(141.0,  31.0,   9.0) / 255.0,
    vec3(141.0,  33.0,   8.0) / 255.0,
    vec3(142.0,  35.0,   7.0) / 255.0,
    vec3(143.0,  37.0,   7.0) / 255.0,
    vec3(144.0,  39.0,   6.0) / 255.0,
    vec3(145.0,  41.0,   6.0) / 255.0,
    vec3(145.0,  42.0,   5.0) / 255.0,
    vec3(146.0,  44.0,   5.0) / 255.0,
    vec3(147.0,  46.0,   4.0) / 255.0,
    vec3(147.0,  48.0,   4.0) / 255.0,
    vec3(148.0,  49.0,   3.0) / 255.0,
    vec3(148.0,  51.0,   3.0) / 255.0,
    vec3(149.0,  53.0,   2.0) / 255.0,
    vec3(150.0,  54.0,   2.0) / 255.0,
    vec3(150.0,  56.0,   2.0) / 255.0,
    vec3(151.0,  58.0,   2.0) / 255.0,
    vec3(151.0,  60.0,   1.0) / 255.0,
    vec3(152.0,  61.0,   1.0) / 255.0,
    vec3(152.0,  63.0,   1.0) / 255.0,
    vec3(153.0,  65.0,   1.0) / 255.0,
    vec3(153.0,  66.0,   1.0) / 255.0,
    vec3(154.0,  68.0,   1.0) / 255.0,
    vec3(154.0,  69.0,   0.0) / 255.0,
    vec3(155.0,  71.0,   0.0) / 255.0,
    vec3(155.0,  73.0,   0.0) / 255.0,
    vec3(155.0,  74.0,   1.0) / 255.0,
    vec3(156.0,  76.0,   1.0) / 255.0,
    vec3(156.0,  78.0,   1.0) / 255.0,
    vec3(157.0,  79.0,   1.0) / 255.0,
    vec3(157.0,  81.0,   1.0) / 255.0,
    vec3(157.0,  82.0,   1.0) / 255.0,
    vec3(158.0,  84.0,   2.0) / 255.0,
    vec3(158.0,  86.0,   2.0) / 255.0,
    vec3(158.0,  87.0,   3.0) / 255.0,
    vec3(158.0,  89.0,   3.0) / 255.0,
    vec3(159.0,  90.0,   4.0) / 255.0,
    vec3(159.0,  92.0,   4.0) / 255.0,
    vec3(159.0,  94.0,   5.0) / 255.0,
    vec3(159.0,  95.0,   6.0) / 255.0,
    vec3(160.0,  97.0,   7.0) / 255.0,
    vec3(160.0,  98.0,   7.0) / 255.0,
    vec3(160.0, 100.0,   8.0) / 255.0,
    vec3(160.0, 101.0,   9.0) / 255.0,
    vec3(160.0, 103.0,  11.0) / 255.0,
    vec3(160.0, 105.0,  12.0) / 255.0,
    vec3(160.0, 106.0,  13.0) / 255.0,
    vec3(160.0, 108.0,  14.0) / 255.0,
    vec3(160.0, 109.0,  15.0) / 255.0,
    vec3(161.0, 111.0,  16.0) / 255.0,
    vec3(161.0, 113.0,  18.0) / 255.0,
    vec3(161.0, 114.0,  19.0) / 255.0,
    vec3(161.0, 116.0,  20.0) / 255.0,
    vec3(161.0, 117.0,  21.0) / 255.0,
    vec3(161.0, 119.0,  23.0) / 255.0,
    vec3(160.0, 120.0,  24.0) / 255.0,
    vec3(160.0, 122.0,  25.0) / 255.0,
    vec3(160.0, 124.0,  26.0) / 255.0,
    vec3(160.0, 125.0,  28.0) / 255.0,
    vec3(160.0, 127.0,  29.0) / 255.0,
    vec3(160.0, 128.0,  30.0) / 255.0,
    vec3(160.0, 130.0,  32.0) / 255.0,
    vec3(160.0, 132.0,  33.0) / 255.0,
    vec3(159.0, 133.0,  35.0) / 255.0,
    vec3(159.0, 135.0,  36.0) / 255.0,
    vec3(159.0, 136.0,  37.0) / 255.0,
    vec3(159.0, 138.0,  39.0) / 255.0,
    vec3(158.0, 140.0,  40.0) / 255.0,
    vec3(158.0, 141.0,  42.0) / 255.0,
    vec3(158.0, 143.0,  43.0) / 255.0,
    vec3(158.0, 144.0,  45.0) / 255.0,
    vec3(157.0, 146.0,  46.0) / 255.0,
    vec3(157.0, 148.0,  48.0) / 255.0,
    vec3(157.0, 149.0,  49.0) / 255.0,
    vec3(156.0, 151.0,  51.0) / 255.0,
    vec3(156.0, 152.0,  52.0) / 255.0,
    vec3(155.0, 154.0,  54.0) / 255.0,
    vec3(155.0, 156.0,  56.0) / 255.0,
    vec3(154.0, 157.0,  57.0) / 255.0,
    vec3(154.0, 159.0,  59.0) / 255.0,
    vec3(153.0, 160.0,  61.0) / 255.0,
    vec3(153.0, 162.0,  62.0) / 255.0,
    vec3(152.0, 163.0,  64.0) / 255.0,
    vec3(152.0, 165.0,  66.0) / 255.0,
    vec3(151.0, 167.0,  68.0) / 255.0,
    vec3(151.0, 168.0,  69.0) / 255.0,
    vec3(150.0, 170.0,  71.0) / 255.0,
    vec3(149.0, 171.0,  73.0) / 255.0,
    vec3(149.0, 173.0,  75.0) / 255.0,
    vec3(148.0, 175.0,  77.0) / 255.0,
    vec3(147.0, 176.0,  79.0) / 255.0,
    vec3(147.0, 178.0,  81.0) / 255.0,
    vec3(146.0, 179.0,  83.0) / 255.0,
    vec3(145.0, 181.0,  85.0) / 255.0,
    vec3(144.0, 183.0,  87.0) / 255.0,
    vec3(144.0, 184.0,  89.0) / 255.0,
    vec3(143.0, 186.0,  92.0) / 255.0,
    vec3(142.0, 187.0,  94.0) / 255.0,
    vec3(141.0, 189.0,  96.0) / 255.0,
    vec3(141.0, 190.0,  98.0) / 255.0,
    vec3(140.0, 192.0, 101.0) / 255.0,
    vec3(139.0, 193.0, 103.0) / 255.0,
    vec3(139.0, 195.0, 106.0) / 255.0,
    vec3(138.0, 196.0, 109.0) / 255.0,
    vec3(137.0, 198.0, 111.0) / 255.0,
    vec3(137.0, 199.0, 114.0) / 255.0,
    vec3(137.0, 201.0, 117.0) / 255.0,
    vec3(136.0, 202.0, 120.0) / 255.0,
    vec3(136.0, 203.0, 122.0) / 255.0,
    vec3(136.0, 205.0, 125.0) / 255.0,
    vec3(136.0, 206.0, 128.0) / 255.0,
    vec3(137.0, 207.0, 131.0) / 255.0,
    vec3(137.0, 208.0, 134.0) / 255.0,
    vec3(138.0, 209.0, 138.0) / 255.0,
    vec3(139.0, 210.0, 141.0) / 255.0,
    vec3(140.0, 211.0, 144.0) / 255.0,
    vec3(141.0, 212.0, 147.0) / 255.0,
    vec3(142.0, 213.0, 150.0) / 255.0,
    vec3(144.0, 214.0, 153.0) / 255.0,
    vec3(146.0, 215.0, 155.0) / 255.0,
    vec3(147.0, 216.0, 158.0) / 255.0,
    vec3(149.0, 217.0, 161.0) / 255.0,
    vec3(151.0, 218.0, 164.0) / 255.0,
    vec3(153.0, 219.0, 167.0) / 255.0,
    vec3(156.0, 220.0, 169.0) / 255.0,
    vec3(158.0, 220.0, 172.0) / 255.0,
    vec3(160.0, 221.0, 175.0) / 255.0,
    vec3(162.0, 222.0, 177.0) / 255.0,
    vec3(165.0, 223.0, 180.0) / 255.0,
    vec3(167.0, 224.0, 182.0) / 255.0,
    vec3(170.0, 224.0, 185.0) / 255.0,
    vec3(172.0, 225.0, 187.0) / 255.0,
    vec3(175.0, 226.0, 189.0) / 255.0,
    vec3(177.0, 227.0, 192.0) / 255.0,
    vec3(179.0, 227.0, 194.0) / 255.0,
    vec3(182.0, 228.0, 196.0) / 255.0,
    vec3(184.0, 229.0, 198.0) / 255.0,
    vec3(187.0, 230.0, 201.0) / 255.0,
    vec3(189.0, 230.0, 203.0) / 255.0,
    vec3(192.0, 231.0, 205.0) / 255.0,
    vec3(194.0, 232.0, 207.0) / 255.0,
    vec3(197.0, 233.0, 209.0) / 255.0,
    vec3(199.0, 234.0, 211.0) / 255.0,
    vec3(202.0, 234.0, 213.0) / 255.0,
    vec3(204.0, 235.0, 215.0) / 255.0,
    vec3(207.0, 236.0, 217.0) / 255.0,
    vec3(209.0, 237.0, 219.0) / 255.0,
    vec3(211.0, 238.0, 221.0) / 255.0,
    vec3(214.0, 238.0, 223.0) / 255.0,
    vec3(216.0, 239.0, 225.0) / 255.0,
    vec3(219.0, 240.0, 227.0) / 255.0,
    vec3(221.0, 241.0, 229.0) / 255.0,
    vec3(223.0, 242.0, 231.0) / 255.0,
    vec3(226.0, 243.0, 233.0) / 255.0,
    vec3(228.0, 244.0, 234.0) / 255.0,
    vec3(230.0, 244.0, 236.0) / 255.0,
    vec3(233.0, 245.0, 238.0) / 255.0,
    vec3(235.0, 246.0, 240.0) / 255.0,
    vec3(237.0, 247.0, 242.0) / 255.0,
    vec3(240.0, 248.0, 243.0) / 255.0,
    vec3(242.0, 249.0, 245.0) / 255.0,
    vec3(244.0, 250.0, 247.0) / 255.0,
    vec3(246.0, 251.0, 248.0) / 255.0,
    vec3(249.0, 252.0, 250.0) / 255.0,
    vec3(251.0, 253.0, 252.0) / 255.0,
    vec3(253.0, 254.0, 253.0) / 255.0,
    vec3(255.0, 255.0, 255.0) / 255.0
  );

  vec4 texelColor = texture(texture0, fragTexCoord);
  float val = clamp(texelColor.r, 0.0, 1.0);

  const int colorCount = 256;
  const int lastColorIdx = colorCount - 1;
  const float segments = float(lastColorIdx);
  float scaled = val * segments;
  int index = int(floor(scaled));
  float t = fract(scaled);

  vec3 baseColor = gnbu_colors[index];
  vec3 nextColor = gnbu_colors[min(index + 1, lastColorIdx)];
  vec3 color = mix(baseColor, nextColor, t);

  finalColor = vec4(color, texelColor.a);
}



